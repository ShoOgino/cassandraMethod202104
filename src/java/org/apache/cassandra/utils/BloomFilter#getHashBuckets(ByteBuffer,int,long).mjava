    // tests ask for ridiculous numbers of hashes so here is a special case for them
    // rather than using the threadLocal like we do in production
    @VisibleForTesting
    public long[] getHashBuckets(ByteBuffer key, int hashCount, long max)
    {
        long[] hash = new long[2];
        hash(key, key.position(), key.remaining(), 0L, hash);
        long[] indexes = new long[hashCount];
        setIndexes(hash[0], hash[1], hashCount, max, indexes);
        return indexes;
    }

