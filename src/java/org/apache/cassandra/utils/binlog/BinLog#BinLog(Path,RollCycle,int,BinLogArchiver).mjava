    /**
     * @param path           Path to store the BinLog. Can't be shared with anything else.
     * @param rollCycle      How often to roll the log file so it can potentially be deleted
     * @param maxQueueWeight Maximum weight of in memory queue for records waiting to be written to the file before blocking or dropping
     */
    public BinLog(Path path, RollCycle rollCycle, int maxQueueWeight, BinLogArchiver archiver)
    {
        Preconditions.checkNotNull(path, "path was null");
        Preconditions.checkNotNull(rollCycle, "rollCycle was null");
        Preconditions.checkArgument(maxQueueWeight > 0, "maxQueueWeight must be > 0");
        ChronicleQueueBuilder builder = ChronicleQueueBuilder.single(path.toFile());
        builder.rollCycle(rollCycle);

        sampleQueue = new WeightedQueue<>(maxQueueWeight);
        this.archiver = archiver;
        builder.storeFileListener(this.archiver);
        queue = builder.build();
        appender = queue.acquireAppender();
    }

