    private SSTableWriter createCompactionWriter(File sstableDirectory, long keysPerSSTable)
    {
        return new SSTableWriter(cfs.getTempSSTablePath(sstableDirectory),
                                 keysPerSSTable,
                                 cfs.metadata,
                                 cfs.partitioner,
                                 new MetadataCollector(toCompact, cfs.metadata.comparator, getLevel()));
    }

