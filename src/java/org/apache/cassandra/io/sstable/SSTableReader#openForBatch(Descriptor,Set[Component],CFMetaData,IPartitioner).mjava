    public static SSTableReader openForBatch(Descriptor descriptor, Set<Component> components, CFMetaData metadata, IPartitioner partitioner) throws IOException
    {
        SSTableMetadata sstableMetadata = openMetadata(descriptor, components, partitioner);
        SSTableReader sstable = new SSTableReader(descriptor,
                                                  components,
                                                  metadata,
                                                  partitioner,
                                                  System.currentTimeMillis(),
                                                  sstableMetadata);
        // don't save index summary to disk if we needed to build one
        sstable.load(false, false);
        sstable.bf = FilterFactory.AlwaysPresent;
        return sstable;
    }

