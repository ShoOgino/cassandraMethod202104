    public void abort()
    {
        if (writer == null)
            return;
        moveStarts(null, Functions.forMap(originalStarts), true);
        List<SSTableReader> close = new ArrayList<>(finished);
        if (currentlyOpenedEarly != null)
            close.add(currentlyOpenedEarly);
        // also remove already completed SSTables
        for (SSTableReader sstable : close)
            sstable.markObsolete();
        // releases reference in replaceReaders
        if (!isOffline)
        {
            dataTracker.replaceReaders(close, Collections.<SSTableReader>emptyList());
            dataTracker.unmarkCompacting(close);
        }
        writer.abort();
    }

