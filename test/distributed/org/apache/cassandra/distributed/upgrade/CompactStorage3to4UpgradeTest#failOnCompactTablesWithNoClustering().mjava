    @Test
    public void failOnCompactTablesWithNoClustering() throws Throwable
    {
        try
        {
            new TestCase()
            .nodes(2)
            .upgrade(Versions.Major.v30, Versions.Major.v4)
            .setup(cluster -> cluster.schemaChange(CREATE_TABLE_R_ONLY))
            .runAfterNodeUpgrade((cluster, node) -> {
                Assert.fail("should never run because we don't expect the node to start");
            })
            .run();
        } catch (RuntimeException e)
        {
            validateError(e);
        }
    }

