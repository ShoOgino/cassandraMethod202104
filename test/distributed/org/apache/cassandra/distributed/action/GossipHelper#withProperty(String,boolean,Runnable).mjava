    public static void withProperty(String prop, boolean value, Runnable r)
    {
        String before = System.getProperty(prop);
        try
        {
            System.setProperty(prop, Boolean.toString(value));
            r.run();
        }
        finally
        {
            System.setProperty(prop, before == null ? "true" : before);
        }
    }

