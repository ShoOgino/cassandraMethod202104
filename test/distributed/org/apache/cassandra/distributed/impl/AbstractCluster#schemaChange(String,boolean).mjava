    private void schemaChange(String query, boolean ignoreStoppedInstances)
    {
        I instance = ignoreStoppedInstances ? getFirstRunningInstance() : get(1);

        instance.sync(() -> {
            try (SchemaChangeMonitor monitor = new SchemaChangeMonitor())
            {
                // execute the schema change
                instance.coordinator().execute(query, ConsistencyLevel.ALL);
                if (ignoreStoppedInstances)
                    monitor.ignoreStoppedInstances();
                monitor.waitForCompletion();
            }
        }).run();
    }

