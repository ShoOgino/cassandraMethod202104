    @Test
    public void setSerDerTest()
    {
        SetSerializer<String> sss = SetType.getInstance(UTF8Type.instance).getSerializer();
        SetSerializer<Integer> iss = SetType.getInstance(Int32Type.instance).getSerializer();

        Set<String> ss = new HashSet(){{ add("Foo"); add("Bar"); }};
        Set<Integer> is = new HashSet(){{ add(3); add(1); add(5); }};

        ByteBuffer sb = sss.serialize(ss);
        ByteBuffer ib = iss.serialize(is);

        assertEquals(sss.deserialize(sb), ss);
        assertEquals(iss.deserialize(ib), is);

        sss.validate(sb);
        iss.validate(ib);

        // string set with integer set type
        assertInvalid(iss, sb);
        // non set value
        assertInvalid(sss, UTF8Type.instance.getSerializer().serialize("foo"));
    }

